{% extends 'base.html.twig' %}

{% block body %}

    {% if is_granted('ROLE_BOSS') %}
        {{ form_start(form) }}
            {{ form_row(form.name) }}
            {{ form_row(form.cost) }}
            {{ form_row(form.duration) }}
            <button type="submit" class="btn btn-primary" formnovalidate>Save</button>
        {{ form_end(form) }}
    {% endif %}

    <div class="row">
        <div class="col-3" >
            <ul class="list group">
                {% if is_granted('ROLE_ADMIN') %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <a href="{{ path('service_index', {'category': 'Queue'}) }}">
                            Queue
                        </a>
                    </li>
                {% endif %}
                {% for cat in category %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <a href="{{ path('service_index' , {'category': cat.name}) }}">
                            {{ cat.name }}
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </div>
        <div class="col-lg-6">
            <ul class="list group">
                <h3>{{ title }}</h3>
                {% for service in services %}
                    {% if is_granted('ROLE_BOSS') and app.user == service.boss.user %}
                        <a href="{{ path('service_edit', {'id': service.id}) }}">
                            <li class="list-group-item d-flex justify-content-between align-items-center">{{ service.name }}
                        </a>
                    {% else %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">{{ service.name }}
                    {% endif %}
                        <span class="badge">{{ service.cost }} kn</span>
                        {% if service.status == 'allowed' %}
                            <a href="{{ path('service_buy', {'id': service.id}) }}" class="card-link">Buy</a>
                            <a href="{{ path('service_add', {'id': service.id}) }}" class="card-link">Add to wishlist</a>
                        {% endif %}
                        {% if is_granted('ROLE_ADMIN') and service.status == 'queued' %}
                            <a href="{{ path('service_allow', {'id': service.id}) }}">
                                Allow
                            </a>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>
{% endblock %}